<view class="container font-lvl-{{fontSizeLevel}} {{isDarkMode ? 'dark-mode' : ''}}">
  <!-- å¤´éƒ¨å¡ç‰‡ -->
  <view class="header-card">
    
    <block wx:if="{{userInfo.isLoggedIn}}">
      <!-- [æ–°å¢] é€€å‡ºç™»å½•æŒ‰é’® -->
      <view class="logout-btn" bindtap="handleLogout">é€€å‡º</view>

      <!-- å·²ç™»å½•çŠ¶æ€ -->
      <view class="user-info">
        <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
          <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
          <view class="edit-badge">ğŸ“·</view>
        </button>
        
        <view class="info-text">
          <view class="nickname-row" bindtap="onEditNickname">
             <view class="nickname">{{userInfo.nickname?userInfo.nickname:'è¯·ç¼–è¾‘æ˜µç§°'}}</view>
             <view class="edit-icon">âœ</view>
          </view>
          <view class="uid">ID: {{userInfo.UID}}</view>
        </view>
      </view>
    </block>

    <block wx:else>
      <!-- æœªç™»å½•çŠ¶æ€ -->
      <view class="login-wrapper" bindtap="handleLogin">
        <view class="avatar-placeholder">
           <text class="placeholder-icon">ğŸ‘¤</text>
        </view>
        <view class="login-info">
          <text class="login-title">ç‚¹å‡»ç™»å½•è´¦æˆ·</text>
          <text class="login-desc">åŒæ­¥å­¦ä¹ è¿›åº¦ä¸æ”¶è—</text>
        </view>
        <view class="login-arrow">></view>
      </view>
    </block>
    
    <!-- ç»Ÿè®¡æ•°æ®æ  -->
    <view class="stats-row">
      <view class="stat-item">
        <view class="num">{{userInfo.isLoggedIn ? userInfo.points:'/'}}</view>
        <view class="label">ç§¯åˆ†</view>
      </view>
      
      <view class="stat-item" bindtap="handleSignIn">
        <view class="num">{{userInfo.hasSignedIn ? 'å·²ç­¾' : 'ç­¾åˆ°'}}</view>
        <view class="label">æ¯æ—¥+20</view>
      </view>

      <button class="stat-item share-btn" open-type="share" bindtap="handleShareTap">
        <view class="num text-orange">{{userInfo.hasSharedToday ? 'å·²äº«' : 'åˆ†äº«'}}</view>
        <view class="label">æ¯æ—¥+15</view>
      </button>

      <view class="stat-item" bindtap="goPurchase">
        <view class="num text-yellow">ğŸ’</view>
        <view class="label">å……å€¼</view>
      </view>
    </view>
  </view>

  <!-- èœå•åˆ—è¡¨ -->
  <view class="menu-list card">
    <view class="menu-item" bindtap="handleFontSize">
      <view class="menu-left">
        <view class="menu-icon purple">A</view>
        <text>å­—ä½“å¤§å°</text>
      </view>
      <view class="menu-right">
        <text class="status-text">{{fontSizeLabel}}</text>
        <text class="arrow">></text>
      </view>
    </view>

    <view class="menu-item" bindtap="handleDarkMode">
      <view class="menu-left">
        <view class="menu-icon blue">ğŸŒ™</view>
        <text>å¤œé—´æ¨¡å¼</text>
      </view>
      <view class="menu-right">
        <view class="toggle-switch {{isDarkMode ? 'on' : 'off'}}">
          <view class="toggle-circle"></view>
        </view>
      </view>
    </view>
    
    <view class="menu-item" bindtap="navigateToContribute">
      <view class="menu-left">
        <view class="menu-icon red">ğŸ™ï¸</view>
        <text>å½•éŸ³è´¡çŒ®</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navigateToPrivacy">
      <view class="menu-left">
        <view class="menu-icon gray">ğŸ”’</view>
        <text>éšç§åè®®</text>
      </view>
      <text class="arrow">></text>
    </view>

    <!-- [ä¿®æ”¹] ç»‘å®šæ–°çš„å¼¹çª—æ–¹æ³• -->
    <view class="menu-item" bindtap="showFeedback">
      <view class="menu-left">
        <view class="menu-icon green">ğŸ’¬</view>
        <text>æ„è§åé¦ˆ</text>
      </view>
      <text class="arrow">></text>
    </view>
  </view>
  
  <view class="footer">Version 1.3.1 Feedback Added</view>

  <!-- [æ–°å¢] æ„è§åé¦ˆå¼¹çª— -->
  <view class="modal-mask" wx:if="{{showFeedbackModal}}" bindtap="hideFeedback">
    <view class="modal-container" catchtap="return">
      <view class="modal-title">æ„è§åé¦ˆ</view>
      <textarea 
        class="feedback-input" 
        placeholder="è¯·è¾“å…¥æ‚¨çš„å®è´µå»ºè®®ï¼Œå¸®åŠ©æˆ‘ä»¬åšå¾—æ›´å¥½..." 
        placeholder-class="input-placeholder"
        bindinput="onFeedbackInput"
        value="{{feedbackContent}}"
        maxlength="200"
        disable-default-padding="true"
      ></textarea>
      <view class="char-count">{{feedbackLen}}/200</view>
      <view class="modal-btns">
        <view class="btn-cancel" bindtap="hideFeedback">å–æ¶ˆ</view>
        <view class="btn-submit" bindtap="submitFeedback">æäº¤</view>
      </view>
    </view>
  </view>
</view>