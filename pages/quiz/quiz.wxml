<view class="container font-lvl-{{fontSizeLevel}} {{isDarkMode ? 'dark-mode' : ''}}">
  
  <!-- é¡¶éƒ¨è¿›åº¦ -->
  <view class="header-bar">
    <view class="progress-info">
      <text class="p-text">è¿›åº¦ {{currentIndex + 1}}/{{quizList.length}}</text>
      <text class="score-text">å¾—åˆ†: {{score}}</text>
    </view>
    <view class="progress-track">
      <view class="progress-fill" style="width: {{((currentIndex + 1) / quizList.length) * 100}}%;"></view>
    </view>
  </view>

  <!-- é¢˜ç›®æ»‘åŠ¨åŒºåŸŸ -->
  <swiper class="quiz-swiper" bindchange="onSwiperChange" current="{{currentIndex}}" previous-margin="40rpx" next-margin="40rpx">
    <block wx:for="{{quizList}}" wx:key="id" wx:for-index="qIdx">
      <swiper-item class="quiz-swiper-item">
        
        <view class="quiz-card">
          <!-- é¢˜ç›®åŒºåŸŸ -->
          <view class="question-area">
            <view class="q-tag">å•è¯è¾¨æ</view>
            <text class="q-word">{{item.question}}</text>
            <view class="play-btn" catchtap="playAudio" data-word="{{item.question}}">ğŸ”Š</view>
            <text class="q-instruction">è¯·é€‰æ‹©æ­£ç¡®çš„ä¸­æ–‡é‡Šä¹‰</text>
          </view>

          <!-- é€‰é¡¹åŒºåŸŸ -->
          <view class="options-area">
            <block wx:for="{{item.options}}" wx:key="*this" wx:for-index="oIdx">
              <!-- 
                 æ ·å¼é€»è¾‘ï¼š
                 1. æœªä½œç­”ï¼šé»˜è®¤æ ·å¼
                 2. å·²ä½œç­” & æ˜¯æ­£ç¡®ç­”æ¡ˆï¼šæ˜¾ç¤ºç»¿è‰² (correct)
                 3. å·²ä½œç­” & ç”¨æˆ·é€‰é”™ & æ˜¯å½“å‰é€‰é¡¹ï¼šæ˜¾ç¤ºçº¢è‰² (wrong)
                 4. å·²ä½œç­” & å…¶ä»–é€‰é¡¹ï¼šå˜æ·¡ (dim)
              -->
              <view 
                class="option-btn {{item.answered ? (oIdx === item.answerIndex ? 'correct' : (item.userChoice === oIdx ? 'wrong' : 'dim')) : ''}}" 
                bindtap="selectOption" 
                data-qindex="{{qIdx}}" 
                data-oindex="{{oIdx}}"
              >
                <text class="opt-text">{{item.options[oIdx]}}</text>
                
                <!-- ç»“æœå›¾æ ‡ -->
                <view class="status-icon" wx:if="{{item.answered}}">
                  <text wx:if="{{oIdx === item.answerIndex}}">âœ“</text>
                  <text wx:if="{{item.userChoice === oIdx && oIdx !== item.answerIndex}}">âœ•</text>
                </view>
              </view>
            </block>
          </view>
          
          <!-- åº•éƒ¨è§£ææç¤º (ç­”é”™æˆ–ç­”å¯¹åæ˜¾ç¤º) -->
          <view class="result-hint {{item.isCorrect ? 'success' : 'error'}}" wx:if="{{item.answered}}">
            <text>{{item.isCorrect ? 'ğŸ‰ å›ç­”æ­£ç¡®ï¼' : 'ğŸ˜… å†æ¥å†å‰ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š' + item.options[item.answerIndex]}}</text>
          </view>

        </view>
      </swiper-item>
    </block>
  </swiper>

  <view class="footer-hint" bindtap="forceNext" wx:if="{{quizList[currentIndex].answered && currentIndex < quizList.length -1}}">
    ç‚¹å‡»æ­¤å¤„æˆ–æ»‘åŠ¨è¿›å…¥ä¸‹ä¸€é¢˜ â†’
  </view>
</view>