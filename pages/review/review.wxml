<view class="container font-lvl-{{fontSizeLevel}} {{isDarkMode ? 'dark-mode' : ''}}">
  
  <!-- 1. é¡¶éƒ¨åŠ¨æ€åŒºåŸŸ -->
  <!-- style="padding-top: {{totalNavHeight}}px; min-height: {{totalNavHeight + 0}}px;" -->
  <view class="home-header"  style="padding-top: 20rpx">
    <view class="header-bg"></view>
    
    <view class="header-content">
      <!-- åœºæ™¯ A: ç¬¬ä¸€å¼ å¡ç‰‡ - æ˜¾ç¤ºé—®å€™ -->
      <!-- wx:if="{{currentIndex === 0}}" -->
      <block>
        <view class="greeting-box">
          <text class="greeting-title">Jambo! ğŸ‘‹</text>
          <text class="greeting-sub">æ–°çš„ä¸€å¤©ï¼Œå¼€å§‹ç§¯ç´¯è¯æ±‡å§</text>
        </view>
        <!-- <view class="today-goal">
          <text class="goal-label">ä»Šæ—¥ç›®æ ‡</text>
          <text class="goal-val">{{wordList.length}} è¯</text>
        </view> -->
      <!-- </block> -->

      <!-- åœºæ™¯ B: å­¦ä¹ è¿›è¡Œä¸­ - æ˜¾ç¤ºæŒ‡æ ‡ -->
      <!-- <block wx:else> -->
        <view class="stats-dashboard">
          <!-- 5ä¸ªç½‘æ ¼æ•°æ® -->
          <view class="stats-grid">
            <view class="stat-item">
              <text class="stat-num">{{knownCount}}</text>
              <text class="stat-label">å·²è®¤è¯†</text>
            </view>
            <view class="stat-line"></view>
            <view class="stat-item">
              <text class="stat-num">{{forgotCount}}</text>
              <text class="stat-label">ä¸è®¤è¯†</text>
            </view>
            <!-- <view class="stat-line"></view>
            <view class="stat-item">
              <text class="stat-num">{{completedCount}}</text>
              <text class="stat-label">å·²åšé¢˜</text>
            </view> -->
            <!-- <view class="stat-line"></view>
            <view class="stat-item">
              <text class="stat-num">{{wordList.length - completedCount}}</text>
              <text class="stat-label">å‰©ä½™</text>
            </view> -->
            <view class="stat-line"></view>
            <view class="stat-item" bind:tap="goPurchase">
              <text class="stat-num highlight">{{!isLoggedIn?'æ¸¸å®¢':(isvip?'å°Šè´µä¼šå‘˜':'è´­ä¹°ä¼šå‘˜')}}</text>
              <text class="stat-label">{{!isLoggedIn?'è¯·å…ˆç™»å½•':(isvip?'ä¼šå‘˜æœŸé™':'æ™®é€šç”¨æˆ·')}}</text>
            </view>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 2. å¡ç‰‡æ ¸å¿ƒå­¦ä¹ åŒº -->
  <view class="swiper-container">
    <swiper 
      class="card-swiper" 
      current="{{currentIndex}}" 
      bindchange="onSwiperChange" 
      previous-margin="40rpx" 
      next-margin="40rpx"
      circular="{{false}}"
    >
      <block wx:for="{{wordList}}" wx:key="index">
        <swiper-item class="card-swiper-item">
          <view class="flip-container {{item.isFlipped ? 'flipped' : ''}}" bindtap="toggleFlip" data-index="{{index}}">
            <view class="flipper">
              
              <!-- æ­£é¢ -->
              <view class="card-face front">
                <view class="card-inner">
                  <view class="card-status-row">
                    <!-- å ä½ç¬¦ -->
                    <view></view> 
                    <image class="tz-flag" src="https://flagcdn.com/w40/tz.png" mode="widthFix" wx:if="{{!item.portrait}}"></image>
                  </view>
                  
                  <view class="main-content-box">
                    <image class="clue-img-large" src="{{item.portrait}}" mode="aspectFill" wx:if="{{item.portrait}}"></image>
                    <view class="text-group">
                      <text class="cn-text-large">{{item.chinese}}</text>
                      <text class="en-text-sub">{{item.english}}</text>
                    </view>
                  </view>

                  <view class="bottom-hint">
                    <text class="hint-dot"></text>
                    <text>ç‚¹å‡»ç¿»è½¬ï¼ŒèƒŒé¢æœ‰æ–¯è¯­ç­”æ¡ˆ</text>
                  </view>
                </view>
              </view>

              <!-- èƒŒé¢ -->
              <view class="card-face back">
                <view class="card-inner back-layout">
                  <view class="card-status-row">
                    <view class="tag-pill green">ç­”æ¡ˆ</view>
                    <view class="play-btn-mini" catchtap="playAudio" data-item="{{item}}">ğŸ”Š</view>
                  </view>
                  
                  <view class="answer-content-box">
                    <text class="sw-word-huge">{{item.swahili}}</text>
                    <view class="homonym-pill">
                      <text class="pill-label">è°éŸ³</text>
                      <text class="pill-val">{{item.xieyin}}</text>
                    </view>
                  </view>

                  <view class="action-grid">
                    <view class="action-btn known-btn" catchtap="markKnown" data-ctitem="{{item.id}}">
                      <text class="btn-emoji">ğŸ˜</text>
                      <text>è®¤è¯†</text>
                    </view>

                    <view class="action-btn forgot-btn" catchtap="markForgot" data-ctitem="{{item.id}}">
                      <text class="btn-emoji">ğŸ¤¯</text>
                      <text>ä¸è®¤è¯†</text>
                    </view>
                  </view>

                </view>
              </view>

            </view>
          </view>

        </swiper-item>
      </block>
    </swiper>
  </view>

  <!-- 3. ç§¯åˆ†ä¸è¶³å¼¹çª— -->
  <!-- <points-modal visible="{{showNoPointsModal}}" beidong="{{beidong}}" /> -->
  <vip-modal visible="{{showNoPointsModal}}" />
  
  <audio-control />
</view>